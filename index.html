<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>NutriLearn Academy: Curso Interactivo de Nutrici√≥n con IA</title>
<!-- Descripci√≥n para resultados de b√∫squeda -->
<meta name="description" content="Aprende nutrici√≥n con ciencia e IA. Calcula tus macros, analiza comidas y crea planes personalizados con nuestro tutor virtual. Tu evoluci√≥n nutricional empieza aqu√≠.">
<meta name="keywords" content="nutrici√≥n, curso nutrici√≥n, aprender nutrici√≥n, macronutrientes, calcular calor√≠as, TDEE, analizador de comida IA, plan alimenticio, salud, bienestar">
<meta name="author" content="NutriLearn Academy">
<meta name="copyright" content="NutriLearn Academy">

<!-- ============================================
     OPEN GRAPH (Facebook, LinkedIn, WhatsApp)
     ============================================ -->
<meta property="og:type" content="website">
<!-- üîó URL CAN√ìNICA DE TU P√ÅGINA -->
<meta property="og:url" content="https://gemini-flash.netlify.app/">
<meta property="og:title" content="NutriLearn Academy: Domina la Nutrici√≥n con Ciencia e IA">
<meta property="og:description" content="La primera academia interactiva que combina bioqu√≠mica, c√°lculo de energ√≠a y un asistente de IA para tu aprendizaje personalizado. ¬°Transforma tu conocimiento en acci√≥n!">
<!-- üñºÔ∏è URL DE TU IMAGEN PARA COMPARTIR -->
<meta property="og:image" content="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTr56Dr76An4sh_diFko9ElRRBMVPdjPXyLzUc6A5bvbg&s=10">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:locale" content="es_ES">

<!-- ============================================
     TWITTER CARD (Apariencia en Twitter/X)
     ============================================ -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@NutriLearn_Acad">
<meta name="twitter:creator" content="@NutriLearn_Acad">
<meta name="twitter:title" content="NutriLearn Academy: Aprende Nutrici√≥n con un Tutor de IA">
<meta name="twitter:description" content="Calcula tus necesidades energ√©ticas, analiza fotos de comida y genera men√∫s al instante. Educaci√≥n nutricional del siglo XXI.">
<meta name="twitter:image" content="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTr56Dr76An4sh_diFko9ElRRBMVPdjPXyLzUc6A5bvbg&s=10">

<!-- ============================================
     FAVICON Y THEME COLOR
     ============================================ -->
<!-- (Opcional) Si subes favicons a tu dominio Netlify, usa estas l√≠neas -->
<!-- <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest"> -->
<meta name="color-scheme" content="light dark">
<meta name="theme-color" content="#faf9f6" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#030712" media="(prefers-color-scheme: dark)">

<!-- ============================================
     ESTRUCTURA JSON-LD (SCHEMA.ORG)
     (Lo m√°s importante para SEO t√©cnico)
     ============================================ -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
      "@id": "https://gemini-flash.netlify.app/#organization",
      "name": "NutriLearn Academy",
      "url": "https://gemini-flash.netlify.app/",
      "logo": {
        "@type": "ImageObject",
        "url": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTr56Dr76An4sh_diFko9ElRRBMVPdjPXyLzUc6A5bvbg&s=10",
        "width": 1200,
        "height": 630
      },
      "description": "Academia especializada en educaci√≥n nutricional interactiva con inteligencia artificial.",
      "sameAs": [
        "https://www.facebook.com/NutriLearnAcademy",
        "https://www.instagram.com/nutrilearn_academy/",
        "https://twitter.com/NutriLearn_Acad"
      ]
    },
    {
      "@type": "WebSite",
      "@id": "https://gemini-flash.netlify.app/#website",
      "url": "https://gemini-flash.netlify.app/",
      "name": "NutriLearn Academy",
      "description": "Curso interactivo de nutrici√≥n con asistente de IA",
      "publisher": {
        "@id": "https://gemini-flash.netlify.app/#organization"
      }
    },
    {
      "@type": "Course",
      "@id": "https://gemini-flash.netlify.app/#course",
      "name": "Curso Interactivo de Nutrici√≥n con IA",
      "description": "Un curso completo que ense√±a los fundamentos de la nutrici√≥n, el c√°lculo de macronutrientes y el balance energ√©tico, utilizando herramientas interactivas y un asistente de inteligencia artificial.",
      "url": "https://gemini-flash.netlify.app/",
      "provider": {
        "@type": "Organization",
        "@id": "https://gemini-flash.netlify.app/#organization"
      },
      "hasCourseInstance": {
        "@type": "CourseInstance",
        "courseMode": ["online", "interactive"],
        "location": {
          "@type": "VirtualLocation",
          "url": "https://gemini-flash.netlify.app/"
        }
      },
      "about": "Nutrici√≥n, Bioqu√≠mica de Alimentos, Metabolismo, Macronutrientes, C√°lculo de Calor√≠as, Planificaci√≥n Alimenticia",
      "educationalLevel": "beginner",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD",
        "availability": "https://schema.org/InStock",
        "url": "https://gemini-flash.netlify.app/"
      }
    }
  ]
}
</script>

<script src="https://cdn.tailwindcss.com"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap');

/* Variables CSS para temas - MODO OSCURO M√ÅXIMO */
:root {
  /* Colores para el tema claro (default) */
  --color-bg-primary: #faf9f6;
  --color-bg-secondary: #ffffff;
  --color-bg-sidebar: #ffffff;
  --color-text-primary: #334155;
  --color-text-secondary: #64748b;
  --color-border: #e2e8f0;
  --color-glass-bg: rgba(255, 255, 255, 0.9);
  --color-glass-border: rgba(255, 255, 255, 0.5);
}

@media (prefers-color-scheme: dark) {
  :root {
    /* Colores para el tema oscuro - VERSI√ìN M√ÅXIMA OSCURIDAD */
    --color-bg-primary: #030712;      /* Casi negro absoluto */
    --color-bg-secondary: #0f172a;    /* Negro azulado muy oscuro */
    --color-bg-sidebar: #0f172a;
    --color-text-primary: #f8fafc;    /* Blanco muy puro para m√°ximo contraste */
    --color-text-secondary: #cbd5e1;
    --color-border: #1e293b;          /* Bordes oscuros */
    --color-glass-bg: rgba(15, 23, 42, 0.95);  /* Vidrio casi opaco */
    --color-glass-border: rgba(30, 41, 59, 0.7);
  }
}

body { 
  font-family: 'Plus Jakarta Sans', sans-serif; 
  background-color: var(--color-bg-primary);
  color: var(--color-text-primary); 
}

.chart-container {
  position: relative;
  width: 100%;
  max-width: 600px;
  height: 300px;
  max-height: 400px;
  margin-left: auto;
  margin-right: auto;
}

@media (min-width: 768px) {
  .chart-container {
    height: 350px;
  }
}

.glass-panel {
  background: var(--color-glass-bg);
  backdrop-filter: blur(12px);
  border: 1px solid var(--color-glass-border);
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

/* Sombra m√°s pronunciada en modo oscuro */
@media (prefers-color-scheme: dark) {
  .glass-panel {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
  }
}

.nav-link {
  position: relative;
  transition: all 0.3s ease;
}

.nav-link.active {
  color: #059669;
  background-color: #ecfdf5;
}

/* Estilo activo para modo oscuro */
@media (prefers-color-scheme: dark) {
  .nav-link.active {
    background-color: #064e3b;
    color: #a7f3d0;
  }
}

.nav-link.active::after {
  content: '';
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  height: 20px;
  width: 4px;
  background-color: #059669;
  border-radius: 4px 0 0 4px;
}

@media (prefers-color-scheme: dark) {
  .nav-link.active::after {
    background-color: #10b981;
  }
}

.loader {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(16, 185, 129, 0.3);
  border-radius: 50%;
  border-top-color: #059669;
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin { to { transform: rotate(360deg); } }
.fade-in { animation: fadeIn 0.4s ease-out forwards; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.chat-scroll::-webkit-scrollbar { width: 6px; }
.chat-scroll::-webkit-scrollbar-track { background: var(--color-bg-secondary); }
.chat-scroll::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
.chat-scroll::-webkit-scrollbar-thumb:hover { background: #64748b; }

/* Ajustar colores de gr√°ficos para modo oscuro */
@media (prefers-color-scheme: dark) {
  #plateChart, #densityChart, #distributionChart {
    filter: brightness(0.9) contrast(1.1);
  }
}

#chat-input::-webkit-search-cancel-button {
    display: none;
}
</style>
</head>
<body class="flex h-screen overflow-hidden">
<aside class="hidden md:flex flex-col w-64 bg-white dark:bg-gray-950 border-r border-slate-200 dark:border-gray-900 h-full z-10">
<div class="p-6 flex items-center gap-3">
<span class="text-3xl">ü•ë</span>
<div>
<h1 class="font-bold text-slate-800 dark:text-gray-100 text-lg leading-tight">NutriLearn</h1>
<p class="text-xs text-emerald-600 font-semibold tracking-wider">ACADEMY AI</p>
</div>
</div>
<nav class="flex-1 px-4 space-y-2 mt-4">
<button onclick="app.navigate('dashboard')" class="nav-link w-full flex items-center gap-3 px-4 py-3 text-slate-600 dark:text-gray-300 rounded-xl hover:bg-slate-50 dark:hover:bg-gray-900 font-medium transition-colors" data-view="dashboard">
<span>üìä</span> Dashboard
</button>
<button onclick="app.navigate('macros')" class="nav-link w-full flex items-center gap-3 px-4 py-3 text-slate-600 dark:text-gray-300 rounded-xl hover:bg-slate-50 dark:hover:bg-gray-900 font-medium transition-colors" data-view="macros">
<span>üß¨</span> Bio-Qu√≠mica
</button>
<button onclick="app.navigate('energy')" class="nav-link w-full flex items-center gap-3 px-4 py-3 text-slate-600 dark:text-gray-300 rounded-xl hover:bg-slate-50 dark:hover:bg-gray-900 font-medium transition-colors" data-view="energy">
<span>‚ö°</span> Lab de Energ√≠a
</button>
<button onclick="app.navigate('ai-suite')" class="nav-link w-full flex items-center gap-3 px-4 py-3 text-slate-600 dark:text-gray-300 rounded-xl hover:bg-slate-50 dark:hover:bg-gray-900 font-medium transition-colors" data-view="ai-suite">
<span>ü§ñ</span> Asistente IA
</button>
</nav>
<div class="p-6 border-t border-slate-100 dark:border-gray-900">
<div class="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-4 text-white shadow-lg">
<p class="text-xs font-medium opacity-90 mb-1">Estado de API</p>
<div class="flex items-center gap-2">
<div class="w-2 h-2 bg-white rounded-full animate-pulse"></div>
<span class="text-sm font-bold">Gemini 2.5 Activo</span>
</div>
</div>
</div>
</aside>
<main class="flex-1 h-full overflow-y-auto relative bg-[#faf9f6] dark:bg-gray-950">
<div class="md:hidden bg-white dark:bg-gray-950 p-4 flex justify-between items-center border-b border-slate-200 dark:border-gray-900 sticky top-0 z-20">
<span class="font-bold text-lg text-slate-800 dark:text-gray-100">ü•ë NutriLearn AI</span>
<button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="text-slate-600 dark:text-gray-300">‚ò∞</button>
</div>
<div id="mobile-menu" class="hidden md:hidden absolute top-16 left-0 w-full bg-white dark:bg-gray-950 border-b border-slate-200 dark:border-gray-900 shadow-xl z-20 flex flex-col p-4 space-y-2">
<button onclick="app.navigate('dashboard')" class="p-3 text-left font-medium text-slate-700 dark:text-gray-200 bg-slate-50 dark:bg-gray-900 rounded-lg">Dashboard</button>
<button onclick="app.navigate('macros')" class="p-3 text-left font-medium text-slate-700 dark:text-gray-200 bg-slate-50 dark:bg-gray-900 rounded-lg">Bio-Qu√≠mica</button>
<button onclick="app.navigate('energy')" class="p-3 text-left font-medium text-slate-700 dark:text-gray-200 bg-slate-50 dark:bg-gray-900 rounded-lg">Lab de Energ√≠a</button>
<button onclick="app.navigate('ai-suite')" class="p-3 text-left font-medium text-slate-700 dark:text-gray-200 bg-slate-50 dark:bg-gray-900 rounded-lg">Asistente IA</button>
</div>
<section id="view-dashboard" class="p-6 md:p-10 max-w-6xl mx-auto fade-in">
<div class="mb-8">
<h2 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-gray-100 mb-4">Bienvenido a tu Evoluci√≥n Nutricional</h2>
<p class="text-lg text-slate-600 dark:text-gray-300 max-w-3xl leading-relaxed">
La nutrici√≥n es la ciencia de c√≥mo los alimentos nutren tu cuerpo. Esta plataforma interactiva combina datos visuales con inteligencia artificial para que pases de la teor√≠a a la pr√°ctica. Empieza explorando tus m√©tricas b√°sicas o consulta a la IA.
</p>
</div>
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
<div class="glass-panel p-6 rounded-2xl border-t-4 border-emerald-500 hover:-translate-y-1 transition-transform cursor-pointer" onclick="app.navigate('macros')">
<div class="flex justify-between items-start mb-4">
<div class="p-3 bg-emerald-100 dark:bg-emerald-900/40 rounded-xl text-2xl">üß¨</div>
<span class="text-xs font-bold bg-slate-100 dark:bg-gray-900 text-slate-500 dark:text-gray-400 px-2 py-1 rounded">Teor√≠a</span>
</div>
<h3 class="text-xl font-bold text-slate-800 dark:text-gray-100 mb-2">Macronutrientes</h3>
<p class="text-sm text-slate-500 dark:text-gray-400">Aprende la diferencia entre combustible (carbos), estructura (prote√≠na) y reserva (grasas).</p>
</div>
<div class="glass-panel p-6 rounded-2xl border-t-4 border-amber-500 hover:-translate-y-1 transition-transform cursor-pointer" onclick="app.navigate('energy')">
<div class="flex justify-between items-start mb-4">
<div class="p-3 bg-amber-100 dark:bg-amber-900/40 rounded-xl text-2xl">‚ö°</div>
<span class="text-xs font-bold bg-slate-100 dark:bg-gray-900 text-slate-500 dark:text-gray-400 px-2 py-1 rounded">C√°lculo</span>
</div>
<h3 class="text-xl font-bold text-slate-800 dark:text-gray-100 mb-2">Balance Energ√©tico</h3>
<p class="text-sm text-slate-500 dark:text-gray-400">Calcula tu TDEE (Gasto Energ√©tico Total Diario) y personaliza tus objetivos.</p>
</div>
<div class="glass-panel p-6 rounded-2xl border-t-4 border-indigo-500 hover:-translate-y-1 transition-transform cursor-pointer" onclick="app.navigate('ai-suite')">
<div class="flex justify-between items-start mb-4">
<div class="p-3 bg-indigo-100 dark:bg-indigo-900/40 rounded-xl text-2xl">üëΩ</div>
<span class="text-xs font-bold bg-indigo-100 dark:bg-indigo-900/40 text-indigo-600 dark:text-indigo-300 px-2 py-1 rounded">Interactivo</span>
</div>
<h3 class="text-xl font-bold text-slate-800 dark:text-gray-100 mb-2">Consultor IA</h3>
<p class="text-sm text-slate-500 dark:text-gray-400">Analiza fotos de platos (descripci√≥n) o pide men√∫s personalizados al instante.</p>
</div>
</div>
<div class="glass-panel p-8 rounded-3xl">
<div class="flex flex-col md:flex-row items-center gap-8">
<div class="flex-1">
<h3 class="text-2xl font-bold text-slate-800 dark:text-gray-100 mb-4">El Plato Saludable Ideal</h3>
<p class="text-slate-600 dark:text-gray-300 mb-6">
M√°s all√° de contar calor√≠as, la proporci√≥n visual es clave. La ciencia moderna sugiere que la mitad de tu ingesta debe provenir de vegetales y frutas para garantizar el aporte de micronutrientes y fibra.
</p>
<ul class="space-y-3">
<li class="flex items-center gap-3 text-sm text-slate-700 dark:text-gray-300">
<span class="w-3 h-3 rounded-full bg-emerald-500"></span> 50% Vegetales y Frutas (Volumen y Fibra)
</li>
<li class="flex items-center gap-3 text-sm text-slate-700 dark:text-gray-300">
<span class="w-3 h-3 rounded-full bg-amber-500"></span> 25% Granos Integrales (Energ√≠a Sostenida)
</li>
<li class="flex items-center gap-3 text-sm text-slate-700 dark:text-gray-300">
<span class="w-3 h-3 rounded-full bg-red-500"></span> 25% Prote√≠na Magra (Reparaci√≥n)
</li>
</ul>
</div>
<div class="flex-1 w-full">
<div class="chart-container">
<canvas id="plateChart"></canvas>
</div>
</div>
</div>
</div>
</section>
<section id="view-macros" class="p-6 md:p-10 max-w-6xl mx-auto hidden fade-in">
<div class="mb-10">
<span class="text-emerald-600 font-bold tracking-wider text-sm uppercase">M√≥dulo 1</span>
<h2 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-gray-100 mb-4">La Qu√≠mica de los Alimentos</h2>
<p class="text-lg text-slate-600 dark:text-gray-300 leading-relaxed">
No todas las calor√≠as son iguales. Entender la densidad cal√≥rica y la funci√≥n metab√≥lica de cada macronutriente es esencial para tomar decisiones informadas. Aqu√≠ visualizamos c√≥mo se compara la energ√≠a que aporta cada gramo.
</p>
</div>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
<div class="glass-panel p-6 rounded-2xl">
<div class="mb-6">
<h3 class="text-xl font-bold text-slate-800 dark:text-gray-100">Densidad Cal√≥rica (kcal/gramo)</h3>
<p class="text-sm text-slate-500 dark:text-gray-400">Observa c√≥mo las grasas contienen m√°s del doble de energ√≠a por gramo que las prote√≠nas o carbohidratos.</p>
</div>
<div class="chart-container">
<canvas id="densityChart"></canvas>
</div>
</div>
<div class="glass-panel p-6 rounded-2xl flex flex-col">
<div class="mb-6">
<h3 class="text-xl font-bold text-slate-800 dark:text-gray-100">Distribuci√≥n de Macronutrientes</h3>
<p class="text-sm text-slate-500 dark:text-gray-400 mb-4">Selecciona un perfil para ver c√≥mo cambia la recomendaci√≥n de ingesta.</p>
<div class="flex gap-2 p-1 bg-slate-100 dark:bg-gray-900 rounded-lg inline-flex">
<button onclick="app.updateDistribution('standard')" class="px-4 py-2 text-sm rounded-md font-medium transition-all bg-white dark:bg-gray-900 shadow-sm text-slate-800 dark:text-gray-200 border border-slate-200 dark:border-gray-800" id="btn-standard">Est√°ndar</button>
<button onclick="app.updateDistribution('athlete')" class="px-4 py-2 text-sm rounded-md font-medium transition-all text-slate-500 dark:text-gray-400 hover:text-slate-700 dark:hover:text-gray-300 hover:bg-slate-100 dark:hover:bg-gray-800" id="btn-athlete">Atleta</button>
<button onclick="app.updateDistribution('keto')" class="px-4 py-2 text-sm rounded-md font-medium transition-all text-slate-500 dark:text-gray-400 hover:text-slate-700 dark:hover:text-gray-300 hover:bg-slate-100 dark:hover:bg-gray-800" id="btn-keto">Low Carb</button>
</div>
</div>
<div class="chart-container flex-grow">
<canvas id="distributionChart"></canvas>
</div>
<div id="dist-text" class="mt-4 p-4 bg-emerald-50 dark:bg-emerald-900/30 rounded-xl text-sm text-emerald-800 dark:text-emerald-200 border border-emerald-100 dark:border-emerald-900/50">
Equilibrio recomendado para la poblaci√≥n general, priorizando salud a largo plazo.
</div>
</div>
</div>
</section>
<section id="view-energy" class="p-6 md:p-10 max-w-6xl mx-auto hidden fade-in">
<div class="mb-10">
<span class="text-amber-500 font-bold tracking-wider text-sm uppercase">M√≥dulo 2</span>
<h2 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-gray-100 mb-4">Laboratorio de Energ√≠a</h2>
<p class="text-lg text-slate-600 dark:text-gray-300 leading-relaxed">
Tu cuerpo es un motor biol√≥gico. Utiliza esta herramienta para estimar tu Tasa Metab√≥lica Basal (lo que quemas en reposo) y tu Gasto Total Diario (TDEE). Estos n√∫meros son el punto de partida para cualquier plan nutricional.
</p>
</div>
<div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
<div class="lg:col-span-5 glass-panel p-8 rounded-3xl h-fit">
<h3 class="font-bold text-xl text-slate-800 dark:text-gray-100 mb-6">Tus Par√°metros</h3>
<div class="space-y-5">
<div class="grid grid-cols-2 gap-4">
<div>
<label class="block text-xs font-bold text-slate-500 dark:text-gray-400 uppercase mb-2">G√©nero</label>
<select id="calc-gender" class="w-full p-3 bg-slate-50 dark:bg-gray-900 border border-slate-200 dark:border-gray-800 rounded-xl focus:ring-2 focus:ring-amber-400 outline-none text-slate-700 dark:text-gray-200">
<option value="male">Hombre</option>
<option value="female">Mujer</option>
</select>
</div>
<div>
<label class="block text-xs font-bold text-slate-500 dark:text-gray-400 uppercase mb-2">Edad</label>
<input type="number" id="calc-age" value="30" class="w-full p-3 bg-slate-50 dark:bg-gray-900 border border-slate-200 dark:border-gray-800 rounded-xl focus:ring-2 focus:ring-amber-400 outline-none text-slate-700 dark:text-gray-200">
</div>
</div>
<div class="grid grid-cols-2 gap-4">
<div>
<label class="block text-xs font-bold text-slate-500 dark:text-gray-400 uppercase mb-2">Peso (kg)</label>
<input type="number" id="calc-weight" value="70" class="w-full p-3 bg-slate-50 dark:bg-gray-900 border border-slate-200 dark:border-gray-800 rounded-xl focus:ring-2 focus:ring-amber-400 outline-none text-slate-700 dark:text-gray-200">
</div>
<div>
<label class="block text-xs font-bold text-slate-500 dark:text-gray-400 uppercase mb-2">Altura (cm)</label>
<input type="number" id="calc-height" value="175" class="w-full p-3 bg-slate-50 dark:bg-gray-900 border border-slate-200 dark:border-gray-800 rounded-xl focus:ring-2 focus:ring-amber-400 outline-none text-slate-700 dark:text-gray-200">
</div>
</div>
<div>
<label class="block text-xs font-bold text-slate-500 dark:text-gray-400 uppercase mb-2">Actividad F√≠sica</label>
<select id="calc-activity" class="w-full p-3 bg-slate-50 dark:bg-gray-900 border border-slate-200 dark:border-gray-800 rounded-xl focus:ring-2 focus:ring-amber-400 outline-none text-slate-700 dark:text-gray-200">
<option value="1.2">Sedentario (Oficina, poco movimiento)</option>
<option value="1.375">Ligera (Ejercicio 1-3 d√≠as/sem)</option>
<option value="1.55">Moderada (Ejercicio 3-5 d√≠as/sem)</option>
<option value="1.725">Intensa (Ejercicio 6-7 d√≠as/sem)</option>
</select>
</div>
<button onclick="app.calculateTDEE()" class="w-full py-4 bg-amber-500 hover:bg-amber-600 text-white font-bold rounded-xl shadow-lg shadow-amber-200/50 dark:shadow-amber-200/20 transition-all transform active:scale-95">
Calcular Requerimientos
</button>
</div>
</div>
<div class="lg:col-span-7 space-y-6">
<div class="bg-gray-950 text-white p-8 rounded-3xl shadow-xl relative overflow-hidden border border-gray-900">
<div class="absolute right-0 top-0 opacity-10 text-9xl transform translate-x-10 -translate-y-10">‚ö°</div>
<div class="relative z-10">
<p class="text-gray-400 font-bold uppercase tracking-widest text-xs mb-2">Gasto Energ√©tico Diario (TDEE)</p>
<div class="flex items-baseline gap-2">
<span id="result-tdee" class="text-6xl font-extrabold text-amber-400">0</span>
<span class="text-xl text-gray-400">kcal/d√≠a</span>
</div>
<p class="mt-4 text-gray-300 max-w-md">Estas son las calor√≠as que necesitas para mantener tu peso actual considerando tu actividad.</p>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div class="glass-panel p-6 rounded-2xl border-l-4 border-emerald-500">
<h4 class="font-bold text-slate-700 dark:text-gray-200 mb-1">D√©ficit (P√©rdida de Grasa)</h4>
<p class="text-3xl font-bold text-emerald-600" id="result-cut">0 <span class="text-sm font-normal text-slate-500 dark:text-gray-400">kcal</span></p>
<p class="text-xs text-gray-500 dark:text-gray-400 mt-2">D√©ficit sostenible del 20%</p>
</div>
<div class="glass-panel p-6 rounded-2xl border-l-4 border-blue-500">
<h4 class="font-bold text-slate-700 dark:text-gray-200 mb-1">Super√°vit (Ganancia Muscular)</h4>
<p class="text-3xl font-bold text-blue-600" id="result-bulk">0 <span class="text-sm font-normal text-slate-500 dark:text-gray-400">kcal</span></p>
<p class="text-xs text-gray-500 dark:text-gray-400 mt-2">Excedente controlado del 10%</p>
</div>
</div>
</div>
</div>
</section>
<section id="view-ai-suite" class="p-6 md:p-10 max-w-6xl mx-auto hidden fade-in">
<div class="mb-10 flex flex-col md:flex-row md:items-center justify-between gap-4">
<div>
<span class="text-indigo-500 font-bold tracking-wider text-sm uppercase">M√≥dulo 3</span>
<h2 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-gray-100">Asistente Nutricional IA</h2>
</div>
<div class="flex items-center gap-2 px-4 py-2 bg-indigo-50 dark:bg-indigo-900/40 text-indigo-700 dark:text-indigo-300 rounded-full text-sm font-bold">
<span>‚ú® Powered by Gemini 2.5 Flash</span>
</div>
</div>
<p class="text-lg text-slate-600 dark:text-gray-300 leading-relaxed mb-8">
Aplica lo aprendido. Usa la Inteligencia Artificial para analizar comidas reales, resolver dudas complejas o generar planes de alimentaci√≥n adaptados a tus c√°lculos del m√≥dulo anterior.
</p>
<div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
<div class="lg:col-span-4 space-y-6">
<div class="glass-panel p-6 rounded-3xl border border-indigo-100 dark:border-indigo-900/40">
<h3 class="font-bold text-lg text-slate-800 dark:text-gray-100 mb-4 flex items-center gap-2">
<span>üì∏</span> Analizar Comida
</h3>
<textarea id="ai-food-input" placeholder="Ej: Dos tostadas con aguacate, un huevo revuelto y caf√© negro..." class="w-full h-32 p-4 bg-white dark:bg-gray-900 border border-slate-200 dark:border-gray-800 rounded-xl focus:ring-2 focus:ring-indigo-400 outline-none resize-none text-sm transition-shadow text-slate-700 dark:text-gray-200 placeholder-slate-400 dark:placeholder-gray-500"></textarea>
<button onclick="app.analyzeFood()" id="btn-analyze" class="w-full mt-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl transition-colors flex justify-center items-center gap-2">
<span>‚ú®</span> Analizar Nutrientes
</button>
</div>
<div class="glass-panel p-6 rounded-3xl border border-emerald-100 dark:border-emerald-900/40">
<h3 class="font-bold text-lg text-slate-800 dark:text-gray-100 mb-4 flex items-center gap-2">
<span>üìÖ</span> Planificador R√°pido
</h3>
<div class="space-y-3">
<select id="ai-plan-goal" class="w-full p-3 bg-white dark:bg-gray-900 border border-slate-200 dark:border-gray-800 rounded-xl text-sm outline-none text-slate-700 dark:text-gray-200">
<option value="p√©rdida de grasa">P√©rdida de Grasa</option>
<option value="ganancia muscular">Ganancia Muscular</option>
<option value="energ√≠a y vitalidad">Energ√≠a y Vitalidad</option>
</select>
<input type="text" id="ai-plan-cal" placeholder="Calor√≠as objetivo (Opcional)" class="w-full p-3 bg-white dark:bg-gray-900 border border-slate-200 dark:border-gray-800 rounded-xl text-sm outline-none text-slate-700 dark:text-gray-200 placeholder-slate-400 dark:placeholder-gray-500">
</div>
<button onclick="app.generatePlan()" id="btn-plan" class="w-full mt-4 py-3 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-xl transition-colors flex justify-center items-center gap-2">
<span>‚ú®</span> Generar Men√∫
</button>
</div>
</div>
<div class="lg:col-span-8 flex flex-col h-[600px] glass-panel rounded-3xl overflow-hidden shadow-2xl border-0">
<div class="bg-gray-950 p-4 flex justify-between items-center border-b border-gray-900">
<span class="text-gray-100 font-bold flex items-center gap-2"><span class="w-2 h-2 bg-emerald-400 rounded-full"></span>Agust√≠n D√≠az</span>
<button onclick="app.clearChat()" class="text-xs text-gray-400 hover:text-white uppercase font-bold tracking-wider">Limpiar</button>
</div>
<div id="chat-container" class="flex-1 overflow-y-auto p-6 space-y-6 bg-slate-50 dark:bg-gray-950 chat-scroll">
<div class="flex gap-4">
<div class="w-8 h-8 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-lg flex-shrink-0">üëΩ</div>
<div class="bg-white dark:bg-gray-900 p-4 rounded-2xl rounded-tl-none shadow-sm text-slate-700 dark:text-gray-200 text-base border border-slate-100 dark:border-gray-800">
<p>¬°Hola! Soy Agust√≠n Diaz, tu maestro de nutrici√≥n. Puedo analizar los ingredientes de tus comidas, explicarte conceptos complejos o crear un plan de alimentaci√≥n basado en tus macros. ¬øPor d√≥nde empezamos?</p>
</div>
</div>
</div>
<div class="p-4 bg-white dark:bg-gray-950 border-t border-slate-100 dark:border-gray-900">
<div class="relative flex items-center">
    <input
  type="search"
  inputmode="text"
  id="chat-input"
  placeholder="Pregunta sobre nutrici√≥n"
  class="w-full
         bg-slate-100 dark:bg-gray-900
         text-slate-700 dark:text-gray-100
         placeholder-slate-400 dark:placeholder-gray-500
         border-none
         rounded-2xl
         py-4 pl-5 pr-14
         focus:ring-2 focus:ring-indigo-500
         outline-none">
    <button onclick="app.sendChat()" class="absolute right-2 p-2 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition-transform active:scale-95">
        ‚û§
    </button>
</div>
</div>
</div>
</div>
</section>
</main>
<script>

const app = {
    state: {
        currentView: 'dashboard',
        tdee: 0,
        distribution: 'standard'
    },
    charts: {},
    
    init: function() {
        this.renderNav();
        this.setupCharts();
        document.getElementById('chat-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') this.sendChat();
        });
    },
    
    renderNav: function() {
        // Navegaci√≥n ya est√° implementada en los botones
    },
    
    navigate: function(viewId) {
        // Ocultar todas las vistas
        ['dashboard', 'macros', 'energy', 'ai-suite'].forEach(id => {
            const view = document.getElementById(`view-${id}`);
            view.classList.add('hidden');
            view.classList.remove('fade-in');
        });
        
        // Mostrar vista objetivo
        const target = document.getElementById(`view-${viewId}`);
        target.classList.remove('hidden');
        setTimeout(() => target.classList.add('fade-in'), 10);
        
        // Actualizar navegaci√≥n activa
        document.querySelectorAll('.nav-link').forEach(el => {
            if (el.dataset.view === viewId) {
                el.classList.add('active');
            } else {
                el.classList.remove('active');
            }
        });
        
        // Cerrar men√∫ m√≥vil si est√° abierto
        document.getElementById('mobile-menu').classList.add('hidden');
    },
    
    setupCharts: function() {
        // Gr√°fico del Plato
        const ctxPlate = document.getElementById('plateChart').getContext('2d');
        this.charts.plate = new Chart(ctxPlate, {
            type: 'pie',
            data: {
                labels: ['Vegetales/Frutas', 'Granos Integrales', 'Prote√≠na Magra'],
                datasets: [{
                    data: [50, 25, 25],
                    backgroundColor: ['#10b981', '#f59e0b', '#ef4444'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { 
                    legend: { 
                        position: 'bottom',
                        labels: {
                            color: '#334155' // Color para modo claro
                        }
                    }
                }
            }
        });
        
        // Gr√°fico de Densidad
        const ctxDensity = document.getElementById('densityChart').getContext('2d');
        this.charts.density = new Chart(ctxDensity, {
            type: 'bar',
            data: {
                labels: ['Vegetales', 'Carbohidratos', 'Prote√≠nas', 'Alcohol', 'Grasas'],
                datasets: [{
                    label: 'Kcal por gramo',
                    data: [0.5, 4, 4, 7, 9],
                    backgroundColor: ['#10b981', '#3b82f6', '#ef4444', '#94a3b8', '#f59e0b'],
                    borderRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { 
                    legend: { 
                        display: false 
                    }
                },
                scales: { 
                    y: { 
                        beginAtZero: true,
                        ticks: {
                            color: '#334155' // Color para modo claro
                        }
                    },
                    x: {
                        ticks: {
                            color: '#334155'
                        }
                    }
                }
            }
        });
        
        // Gr√°fico de Distribuci√≥n
        const ctxDist = document.getElementById('distributionChart').getContext('2d');
        this.charts.dist = new Chart(ctxDist, {
            type: 'doughnut',
            data: {
                labels: ['Carbohidratos', 'Prote√≠nas', 'Grasas'],
                datasets: [{
                    data: [50, 20, 30],
                    backgroundColor: ['#3b82f6', '#ef4444', '#f59e0b'],
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '75%',
                plugins: {
                    legend: { 
                        position: 'right',
                        labels: {
                            color: '#334155'
                        }
                    },
                    title: { 
                        display: true, 
                        text: 'Perfil Est√°ndar',
                        color: '#334155'
                    }
                }
            }
        });
        
        // Actualizar colores de gr√°ficos para modo oscuro
        const updateChartColors = () => {
            const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const textColor = isDark ? '#f8fafc' : '#334155';
            
            // Actualizar gr√°fico de plato
            this.charts.plate.options.plugins.legend.labels.color = textColor;
            this.charts.plate.update();
            
            // Actualizar gr√°fico de densidad
            this.charts.density.options.scales.y.ticks.color = textColor;
            this.charts.density.options.scales.x.ticks.color = textColor;
            this.charts.density.update();
            
            // Actualizar gr√°fico de distribuci√≥n
            this.charts.dist.options.plugins.legend.labels.color = textColor;
            this.charts.dist.options.plugins.title.color = textColor;
            this.charts.dist.update();
        };
        
        // Escuchar cambios en el tema
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', updateChartColors);
        
        // Aplicar colores iniciales
        updateChartColors();
    },
    
    updateDistribution: function(profile) {
        // Actualizar botones
        ['standard', 'athlete', 'keto'].forEach(id => {
            const btn = document.getElementById(`btn-${id}`);
            btn.className = (id === profile)
                ? "px-4 py-2 text-sm rounded-md font-medium transition-all bg-white dark:bg-gray-900 shadow-sm text-slate-800 dark:text-gray-200 border border-slate-200 dark:border-gray-800"
                : "px-4 py-2 text-sm rounded-md font-medium transition-all text-slate-500 dark:text-gray-400 hover:text-slate-700 dark:hover:text-gray-300 hover:bg-slate-100 dark:hover:bg-gray-800";
        });
        
        let data, text, title;
        if (profile === 'standard') {
            data = [50, 20, 30];
            title = "Perfil Est√°ndar";
            text = "Equilibrio recomendado para la poblaci√≥n general.";
        } else if (profile === 'athlete') {
            data = [55, 25, 20];
            title = "Perfil Atleta";
            text = "Optimizado para rendimiento y recuperaci√≥n muscular.";
        } else if (profile === 'keto') {
            data = [10, 30, 60];
            title = "Perfil Low Carb/Keto";
            text = "Uso de grasas como fuente principal de energ√≠a.";
        }
        
        this.charts.dist.data.datasets[0].data = data;
        this.charts.dist.options.plugins.title.text = title;
        this.charts.dist.update();
        document.getElementById('dist-text').innerText = text;
    },
    
    calculateTDEE: function() {
        const gender = document.getElementById('calc-gender').value;
        const age = parseFloat(document.getElementById('calc-age').value) || 0;
        const weight = parseFloat(document.getElementById('calc-weight').value) || 0;
        const height = parseFloat(document.getElementById('calc-height').value) || 0;
        const activity = parseFloat(document.getElementById('calc-activity').value) || 1.2;
        
        if (!age || !weight || !height) return;
        
        let bmr = (10 * weight) + (6.25 * height) - (5 * age);
        bmr += (gender === 'male') ? 5 : -161;
        const tdee = Math.round(bmr * activity);
        
        this.state.tdee = tdee;
        document.getElementById('result-tdee').innerText = tdee;
        document.getElementById('result-cut').innerHTML = `${Math.round(tdee * 0.8)} <span class="text-sm text-slate-500 dark:text-gray-400">kcal</span>`;
        document.getElementById('result-bulk').innerHTML = `${Math.round(tdee * 1.1)} <span class="text-sm text-slate-500 dark:text-gray-400">kcal</span>`;
    },
    
    // REEMPLAZA la funci√≥n 'callGemini' actual por esta:
callGemini: async function(prompt, systemInstruction = "Tu nombre es Agust√≠n D√≠az y eres un experto nutricionista.") {
    // Direcci√≥n de TU funci√≥n Netlify
    const functionUrl = '/.netlify/functions/chat';
    
    try {
        const response = await fetch(functionUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ prompt, systemInstruction })
        });
        
        const data = await response.json();
        
        if (!response.ok) {
            throw new Error(data.error || 'Error en el servidor');
        }
        
        return data.reply;
    } catch (error) {
        return `‚ö†Ô∏è Error al conectar con el asistente: ${error.message}`;
    }
},
    
    addMessage: function(role, text) {
        const container = document.getElementById('chat-container');
        const isUser = role === 'user';
        
        const wrapper = document.createElement('div');
        wrapper.className = `flex gap-4 ${isUser ? 'justify-end' : ''}`;
        
        const avatar = isUser ? '' : '<div class="w-8 h-8 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-lg flex-shrink-0">üëΩ</div>';
        const bubble = document.createElement('div');
        bubble.className = isUser
            ? 'bg-indigo-600 text-white p-4 rounded-2xl rounded-tr-none'
            : 'bg-white dark:bg-gray-900 p-4 rounded-2xl rounded-tl-none border border-slate-100 dark:border-gray-800';
        bubble.innerHTML = text.replace(/\n/g, '<br>');
        
        wrapper.innerHTML = isUser ? bubble.outerHTML : avatar + bubble.outerHTML;
        container.appendChild(wrapper);
        container.scrollTop = container.scrollHeight;
    },
    
    analyzeFood: async function() {
        const input = document.getElementById('ai-food-input').value;
        if (!input) return;
        
        const btn = document.getElementById('btn-analyze');
        btn.disabled = true;
        btn.innerHTML = '<span class="loader"></span>';
        
        this.addMessage('user', `Analiza esto: ${input}`);
        this.addMessage('ai', 'Analizando composici√≥n nutricional...');
        
        const prompt = `Act√∫a como nutricionista. Analiza: "${input}". 
        1. Calor√≠as estimadas. 
        2. Macros aproximados (prote√≠nas, carbohidratos, grasas). 
        3. Puntos positivos y negativos. 
        4. Sugerencias para mejorar. 
        5. Veredicto final (¬øEs una comida saludable?).`;
        
        const response = await this.callGemini(prompt);
        this.addMessage('ai', response);
        
        btn.disabled = false;
        btn.innerHTML = '<span>‚ú®</span> Analizar Nutrientes';
    },
    
    generatePlan: async function() {
        const goal = document.getElementById('ai-plan-goal').value;
        const cal = document.getElementById('ai-plan-cal').value;
        
        const btn = document.getElementById('btn-plan');
        btn.disabled = true;
        btn.innerHTML = '<span class="loader"></span>';
        
        const prompt = `Crea un men√∫ diario detallado para el objetivo: ${goal}. 
        ${cal ? `Calor√≠as objetivo: ${cal}.` : ''}
        Incluye:
        1. Desayuno
        2. Almuerzo
        3. Cena
        4. 2 meriendas/snacks
        5. Total cal√≥rico estimado
        6. Distribuci√≥n de macronutrientes
        7. Consejos para preparaci√≥n`;
        
        
        this.addMessage('user', `Genera un plan para ${goal}`);
        this.addMessage('ai', 'Dise√±ando tu men√∫ personalizado...');
        
        const response = await this.callGemini(prompt);
        this.addMessage('ai', response);
        
        btn.disabled = false;
        btn.innerHTML = '<span>‚ú®</span> Generar Men√∫';
    },
    
    sendChat: async function() {
        const input = document.getElementById('chat-input');
        const text = input.value;
        if (!text) return;
        
        input.value = '';
        this.addMessage('user', text);
        
        const container = document.getElementById('chat-container');
        
        const thinking = document.createElement('div');
        thinking.id = 'thinking-bubble';
        thinking.className = 'flex gap-4';
        thinking.innerHTML = '<div class="w-8 h-8 bg-indigo-100 dark:bg-indigo-900 rounded-full flex items-center justify-center"></div><div class="bg-white dark:bg-gray-900 p-4 rounded-2xl border border-slate-100 dark:border-gray-800"><div class="loader"></div></div>';
        
        container.appendChild(thinking);
        container.scrollTop = container.scrollHeight;
        
        const response = await this.callGemini(text, "Tu nombre es Agust√≠n Diaz y eres mi maestro de nutrici√≥n certificado. Responde con base cient√≠fica, s√© claro y conciso. Estas √∫nicamente para hablar de nutrici√≥n");
        
        thinking.remove();
        this.addMessage('ai', response);
    },
    
    clearChat: function() {
        document.getElementById('chat-container').innerHTML = '';
        this.addMessage('ai', 'Chat reiniciado. ¬øEn qu√© puedo ayudarte hoy?');
    }
};

window.onload = () => app.init();
</script>
</body>
</html>